<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <link rel="manifest" href="manifest.json">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bara skriv!</title>
    <style type="text/css">
        body {
            display: flex;
            padding: 0;
            margin: 0;
            height: 100%;
            width: 100%;
            position: absolute;
        }

        #textInput {
            flex: 1;
            font-size: 500%;
            border: none;
            padding: 10px;
            margin: 0;
            text-transform: uppercase;
        }
    </style>
    <script lang="javascript">
        const KEYCODE_TAB = 9
        window.addEventListener('load', () => {
            const textArea = document.getElementById('textInput')

            // Restore input from previous session
            const previousText = localStorage.getItem('text')
            textArea.value = previousText || ''

            // Enable auto-saving.
            const saveCurrentInput = () => {
                localStorage.setItem('text', textArea.value)
            }
            textArea.addEventListener('keyup', saveCurrentInput)

            // Prevent user from moving the input caret, effectively ensuring that text is always appended (never inserted).
            const moveInputCaretToEnd = () => {
                const length = textArea.value.length
                textArea.setSelectionRange(length, length)
            }
            textArea.addEventListener('click', moveInputCaretToEnd)

            // Make sure text field is always focused, even if user presses the Tab key.
            const preventChangingFocus = (e) =>  {
                const isTabPressed = (e.key === 'Tab' || e.keyCode === KEYCODE_TAB)
                if (isTabPressed) {
                    if (document.activeElement === textArea) {
                        e.preventDefault()
                    }
                }
            }
            textArea.addEventListener('keydown', preventChangingFocus)

            // Auto-focus on input field when page loads.
            setTimeout(() => {
                textArea.focus()
            }, 0)
        })
    </script>
</head>

<body>
    <textarea id="textInput" spellcheck="false" autocomplete="off" autocorrect="off" tabindex="0"></textarea>
</body>

</html>